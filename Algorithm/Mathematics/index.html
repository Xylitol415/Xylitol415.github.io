

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Seon Fang">
  <meta name="keywords" content="计算机 编程 JAVA C++">
  
    <meta name="description" content="本文包含常用数学知识相关算法的java语言实现，如判断素数，素数筛法，分解质因数，约数判定，约数个数与约数之和，欧几里得算法，欧拉函数，快速幂，高斯消元，求组合数等，未完待补充...">
<meta property="og:type" content="article">
<meta property="og:title" content="算法之数学知识">
<meta property="og:url" content="http://example.com/Algorithm/Mathematics/index.html">
<meta property="og:site_name" content="Seon&#39;s Blog">
<meta property="og:description" content="本文包含常用数学知识相关算法的java语言实现，如判断素数，素数筛法，分解质因数，约数判定，约数个数与约数之和，欧几里得算法，欧拉函数，快速幂，高斯消元，求组合数等，未完待补充...">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/Algorithm/Base/DataStructure_Tree.png">
<meta property="article:published_time" content="2022-05-12T07:23:24.000Z">
<meta property="article:modified_time" content="2022-05-18T07:58:10.858Z">
<meta property="article:author" content="Seon Fang">
<meta property="article:tag" content="算法">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/Algorithm/Base/DataStructure_Tree.png">
  
  
  <title>算法之数学知识 - Seon&#39;s Blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/monokai.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->

  
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC&display=swap.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":"§"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.1"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Seon&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/Algorithm/Base/DataStructure_Tree.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="算法之数学知识">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-05-12 15:23" pubdate>
        2022年5月12日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      11k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      96 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">算法之数学知识</h1>
            
              <p class="note note-info">
                
                  本文最后更新于：2022年5月18日 下午
                
              </p>
            
            <div class="markdown-body">
              <h2 id="数学知识">数学知识</h2>
<h3 id="素数质数相关">素数（质数）相关</h3>
<h4 id="试除法判定质数">试除法判定质数</h4>
<p>质数：在大于<code>1</code>的整数中，如果只包含<code>1</code>和<code>本身</code>这两个约数，就被称为质数，也可以叫做素数</p>
<p>约数都是成对出现的，所以只需要枚举每一对中较小的那一个，就可以将时间复杂度从<span class="math inline">\(O(n)\)</span>降到<span class="math inline">\(O(sqrt(n))\)</span>。</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isPrim</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;<br>    <span class="hljs-keyword">if</span>(x &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>; i &lt;= x / i; i++) &#123;<br>        <span class="hljs-keyword">if</span>(x % i == <span class="hljs-number">0</span>) <br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<h4 id="试除法分解质因数">试除法分解质因数</h4>
<p>例题<a target="_blank" rel="noopener" href="https://www.acwing.com/problem/content/869/">acw867. 分解质因数</a>：给定 <span class="math inline">\(n\)</span> 个正整数<span class="math inline">\(a_i\)</span>，将每个数分解质因数，并按照质因数从小到大的顺序输出每个质因数的底数和指数。</p>
<p>数据范围：<span class="math inline">\(1\leq n\leq 100, 2\leq a_i \leq 2 \times 10^9\)</span></p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">divide</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>; i &lt;= x / i; i++) &#123;<br>        <span class="hljs-keyword">if</span>(x % i == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">while</span>(x % i == <span class="hljs-number">0</span>) &#123;<br>                x /= i;<br>                s++;<br>            &#125;<br>            System.out.println(i + <span class="hljs-string">&quot; &quot;</span> + s);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(x &gt; <span class="hljs-number">1</span>) System.out.println(x + <span class="hljs-string">&quot; &quot;</span> + <span class="hljs-number">1</span>);<br>    System.out.print(<span class="hljs-string">&quot;\n&quot;</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure>
<h4 id="素数筛法">素数筛法</h4>
<p>题目：给定一个正整数<span class="math inline">\(n\)</span>，请你求出 <span class="math inline">\(1∼n\)</span>中质数的个数。</p>
<h5 id="朴素筛法-onlogn">朴素筛法 <span class="math inline">\(O(nlogn)\)</span></h5>
<p>遍历<span class="math inline">\(2∼n\)</span>，把每个数的倍数都筛掉</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">N</span> <span class="hljs-operator">=</span> <span class="hljs-number">1000010</span>;<br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] primes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N];       <span class="hljs-comment">// 存储所有素数</span><br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> cnt;                         <span class="hljs-comment">// 统计素数个数</span><br><span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span>[] st = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[N];   <span class="hljs-comment">// st[x]判断x是否被筛掉</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">get_primes</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> &#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>; i &lt;= n; i++) &#123;<br>        <span class="hljs-keyword">if</span>(!st[i]) primes[cnt++] = i;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> i; j &lt;= n; j += i) &#123;<br>            st[j] = <span class="hljs-literal">true</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<h5 id="埃氏筛法-onloglogn">埃氏筛法 <span class="math inline">\(O(nloglogn)\)</span></h5>
<p>可以用质数就把所有的合数都筛掉</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">get_primes</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> &#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>; i &lt;= n; i++) &#123;<br>        <span class="hljs-keyword">if</span>(!st[i]) &#123;<br>            primes[cnt++] = i;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> i; j &lt;= n; j += i) &#123;<br>                st[j] = <span class="hljs-literal">true</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<h5 id="线性筛法欧拉筛法-on">线性筛法（欧拉筛法） <span class="math inline">\(O(n)\)</span></h5>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">get_primes</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span> ; i &lt;= n ; i ++ )&#123;<br>        <span class="hljs-keyword">if</span>(!st[i]) pr[cnt++] = i;<span class="hljs-comment">//将没有被标记的点加入到primes数组中去，也就是质数</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span> ; primes[j] &lt;= n / i; j++)&#123;<span class="hljs-comment">//从小到大遍历质数</span><br>            st[primes[j]*i] = <span class="hljs-literal">true</span>; <span class="hljs-comment">//每一次让primes[j]*i标记</span><br>            <span class="hljs-keyword">if</span>(i % primes[j] == <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>;<br>            <span class="hljs-comment">//只要pi % primes[j] == 0说明他是primes[j]*i的最小质因数了,然后结束循环，</span><br>            <span class="hljs-comment">//如果不break循环的话就会进行primes[j+1]*i晒掉，因为primes[j+1]*i的最小质因数</span><br>            <span class="hljs-comment">//不是primes[j+1],所以会导致重复删除，这也是线性筛的优点所在</span><br>            <span class="hljs-comment">//例如：st[2*4=8]标记之后，如果你不在下面判断if(4%2==0)break掉</span><br>            <span class="hljs-comment">//就会继续primes[(j+1)]*i== st[3*4=12],3不是12的最小质因数，所以这样也是</span><br>            <span class="hljs-comment">//会导致重复删除，执行到i=6时候，st[2*6=12]会再次标记，这样也就在此导致重复了</span><br><br>            <span class="hljs-comment">//i % primes[j] != 0 说明primes[j]永远是primes[j]*i的最小质因数</span><br>            <span class="hljs-comment">//因为primes[j]的最小质因数是本身primes[j]，然后primes[j]*i是primes[j]的倍数</span><br>            <span class="hljs-comment">//所以primes[j]*i的最小质因数也是primes[j]，永远都是，primes[j+1]*i的时候也是</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<h3 id="约数相关">约数相关</h3>
<p><strong>定义</strong></p>
<p>若整数 <span class="math inline">\(n\)</span> 除以整数 <span class="math inline">\(d\)</span> 的余数为 <span class="math inline">\(0\)</span>，即 <span class="math inline">\(d\)</span> 能整除 <span class="math inline">\(n\)</span>，则称 <span class="math inline">\(d\)</span> 是<span class="math inline">\(n\)</span>的约数，<span class="math inline">\(n\)</span> 是 <span class="math inline">\(d\)</span> 的倍数，记为 <span class="math inline">\(d|n\)</span>。</p>
<h4 id="试除法求所有约数">试除法求所有约数</h4>
<p>若 <span class="math inline">\(d \ge \sqrt{N}\)</span> 是 <span class="math inline">\(N\)</span> 的约数，则 <span class="math inline">\(N/d \le \sqrt{N}\)</span> 也是 <span class="math inline">\(N\)</span> 的约数。换言之，约数总是成对出现的（除了对于完全平方数，<span class="math inline">\(\sqrt{N}\)</span> 会单独出现）。因此，只需要扫描 <span class="math inline">\(d=1\sim\sqrt{N}\)</span>，尝试 <span class="math inline">\(d\)</span> 是否能整除 <span class="math inline">\(N\)</span>， 若能整除，则 <span class="math inline">\(N/d\)</span> 也是 <span class="math inline">\(N\)</span> 的约数。时间复杂度为 <span class="math inline">\(O(\sqrt{N})\)</span>。</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Integer&gt; <span class="hljs-title function_">get_divisors</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;<br>    List&lt;Integer&gt; res = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= x / i; i++) &#123;<br>        <span class="hljs-keyword">if</span>(x % i == <span class="hljs-number">0</span>) &#123;<br>            res.add(i);<br>            <span class="hljs-keyword">if</span>(i != x / i) res.add(x / i);<br>        &#125;<br>    &#125;<br>    Collections.sort(res);<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<p><strong>试除法推论</strong></p>
<p>一个整数 <span class="math inline">\(N\)</span> 的约数个数上界为 <span class="math inline">\(2\sqrt{N}\)</span>。</p>
<h4 id="约数个数和约数之和">约数个数和约数之和</h4>
<p><strong>算术基本定理的推论</strong></p>
<p>在算术基本定理中，若正整数 <span class="math inline">\(N\)</span> 被唯一分解为 <span class="math inline">\(N=p_{1}^{c_1}p_{2}^{c_2}\cdots p_{m}^{c_m}\)</span>，其中 <span class="math inline">\(c_i\)</span> 都是正整数，<span class="math inline">\(p_i\)</span> 都是质数，且满足 <span class="math inline">\(p_1&lt;p_2&lt;\cdots&lt;p_m\)</span>，则 <span class="math inline">\(N\)</span> 的正约数集合可写作：</p>
<p><span class="math inline">\(\lbrace p_{1}^{b_1}p_{2}^{b_2}\cdots p_{m}^{b_m} \rbrace\)</span>，其中$ 0b_i c_i$</p>
<p><span class="math inline">\(N\)</span> 的正约数个数为（<span class="math inline">\(\prod\)</span>为连乘符号）：</p>
<p><span class="math inline">\((c_1+1)*(c_2+1)*\cdots*(c_m+1)=\prod\limits_{i=1}\limits^{m}(c_i+1)\)</span></p>
<p><span class="math inline">\(N\)</span> 的所有正约数的和为：</p>
<p><span class="math inline">\((1+p_1+p_1^2+\cdots+p_1^{c_1})*\cdots*(1+p_m+p_m^2+\cdots+p_m^{c_m})=\prod\limits_{i=1}\limits^{m}(\sum\limits_{j=0}\limits^{c_i}(p_i)^j)\)</span></p>
<p><strong>约数个数</strong></p>
<p>例题：给定 <span class="math inline">\(n\)</span> 个正整数 <span class="math inline">\(a_i\)</span>，请你输出这些数的乘积的约数个数，答案对 <span class="math inline">\(10^9+7\)</span> 取模。</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">MOD</span> <span class="hljs-operator">=</span> <span class="hljs-number">1000000007</span>;<br><span class="hljs-keyword">static</span> Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;(); <span class="hljs-comment">// map存储约数和对应个数</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-type">Scanner</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> in.nextInt();<br>    <span class="hljs-keyword">while</span>(n-- &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> in.nextInt();<br>        <span class="hljs-comment">// 计算每个数的所有约数及个数存入map</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>; i &lt;= x / i; i++) &#123;<br>            <span class="hljs-keyword">while</span>(x % i == <span class="hljs-number">0</span>) &#123;<br>                x /= i;<br>                map.put(i, map.getOrDefault(i, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(x &gt; <span class="hljs-number">1</span>) map.put(x, map.getOrDefault(x, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-type">long</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span>(Map.Entry&lt;Integer, Integer&gt; entry : map.entrySet()) &#123;<br>        <span class="hljs-comment">// 约数个数</span><br>        res = res * (entry.getValue() + <span class="hljs-number">1</span>) % MOD;<br>    &#125;<br>    System.out.println(res);<br>&#125;<br></code></pre></div></td></tr></table></figure>
<p><strong>约数之和</strong></p>
<p>例题：给定 <span class="math inline">\(n\)</span> 个正整数 <span class="math inline">\(a_i\)</span>，请你输出这些数的乘积的约数之和，答案对 <span class="math inline">\(10^9+7\)</span> 取模。</p>
<p>关键代码：<code>while(b-- &gt; 0) t = (t * a + 1) % MOD;</code>，运行过程如下所示：</p>
<p><span class="math display">\[t=t∗p+1\]</span> <span class="math display">\[t=1\]</span> <span class="math display">\[t=p+1\]</span> <span class="math display">\[t=p^2+p+1\]</span> <span class="math display">\[\cdots\cdots\]</span> <span class="math display">\[t=p^b+p^{b−1}+\cdots+1\]</span></p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">MOD</span> <span class="hljs-operator">=</span> <span class="hljs-number">1000000007</span>;<br><span class="hljs-keyword">static</span> Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-type">Scanner</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> in.nextInt();<br>    <span class="hljs-keyword">while</span>(n-- &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> in.nextInt();<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>; i &lt;= x / i; i++) &#123;<br>            <span class="hljs-keyword">while</span>(x % i == <span class="hljs-number">0</span>) &#123;<br>                x /= i;<br>                map.put(i, map.getOrDefault(i, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(x &gt; <span class="hljs-number">1</span>) map.put(x, map.getOrDefault(x, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-type">long</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span>(Map.Entry&lt;Integer, Integer&gt; entry : map.entrySet()) &#123;<br>        <span class="hljs-type">long</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>        <span class="hljs-type">long</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> entry.getKey();<br>        <span class="hljs-type">long</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> entry.getValue();<br>        <span class="hljs-comment">// 约数之和</span><br>        <span class="hljs-keyword">while</span>(b-- &gt; <span class="hljs-number">0</span>) t = (t * a + <span class="hljs-number">1</span>) % MOD;<br>        res = res * t % MOD;<br>    &#125;<br>    System.out.println(res);<br>&#125;<br></code></pre></div></td></tr></table></figure>
<h4 id="最大公约数">最大公约数</h4>
<p><strong>定义</strong></p>
<p>若自然数 <span class="math inline">\(d\)</span> 同时是自然数 <span class="math inline">\(a\)</span> 和 <span class="math inline">\(b\)</span> 的约数，则称 <span class="math inline">\(d\)</span> 是 <span class="math inline">\(a\)</span> 和 <span class="math inline">\(b\)</span> 的公约数。在所有 <span class="math inline">\(a\)</span> 和 <span class="math inline">\(b\)</span> 的公约数中最大的一个，称为 <span class="math inline">\(a\)</span> 和 <span class="math inline">\(b\)</span> 的最大公约数，记为 <span class="math inline">\(gcd(a,b)\)</span>。</p>
<p>若自然数 <span class="math inline">\(m\)</span> 同时是自然数 <span class="math inline">\(a\)</span> 和 <span class="math inline">\(b\)</span> 的倍数，则称 <span class="math inline">\(m\)</span> 是 <span class="math inline">\(a\)</span> 和 <span class="math inline">\(b\)</span> 的公倍数。在所有 <span class="math inline">\(a\)</span> 和 <span class="math inline">\(b\)</span> 的公倍数中最小的一个，称为 <span class="math inline">\(a\)</span> 和 <span class="math inline">\(b\)</span> 的最小公倍数，记为 <span class="math inline">\(lcm(a,b)\)</span>。</p>
<p><strong>定理</strong></p>
<p><span class="math display">\[\forall a,b \in \mathbb{N},\quad gcd(a,b)*lcm(a,b) = a*b\]</span></p>
<p><strong>九章算术·更相减损术</strong></p>
<p><span class="math inline">\(\forall a,b \in \mathbb{N}, a\ge b\)</span>，有 <span class="math inline">\(gcd(a, b)=gcd(b,a-b)=gcd(a,a-b)\)</span></p>
<p><span class="math inline">\(\forall a,b \in \mathbb{N}\)</span>，有 <span class="math inline">\(gcd(2a,2b)=2gcd(a,b)\)</span></p>
<p><strong>欧几里得算法</strong></p>
<p><span class="math inline">\(\forall a,b \in \mathbb{N}, b \ne 0,\quad gcd(a,b)=gcd(b, a\, mod \, b)\)</span></p>
<ul>
<li><p>一般有：若<code>d|a</code>且<code>d|b</code>,则<code>d|(a*x+b*y)</code></p></li>
<li><p>证明： 设<code>a%b = a - k*b</code>其中<code>k = a/b</code>(向下取整) 若d是<code>(a,b)</code>的公约数 则知<code>d|a</code> 且 <code>d|b</code> 则易知<code>d|(a-k*b)</code>故d也是<code>(b,a%b)</code>的公约数 若d是<code>(b,a%b)</code>的公约数 则知 <code>d|b</code> 且 <code>d|(a-k*b)</code>则<code>d|(a-k*b+k*b) = d|a</code>，故而 d也是<code>(a,b)</code>的公约数 因此<code>(a,b)</code>的公约数集合和<code>(b,a%b)</code>的公约数集合相同 所以他们的最大公约数也相同，证毕。</p></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">gcd</span><span class="hljs-params">(<span class="hljs-type">int</span> a,<span class="hljs-type">int</span> b)</span>&#123;<br>    <span class="hljs-keyword">return</span> b != <span class="hljs-number">0</span> ? gcd(b,a % b) : a;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<h3 id="求欧拉函数">求欧拉函数</h3>
<p><strong>互质定义</strong></p>
<p><span class="math inline">\(\forall a,b \in \mathbb{N}\)</span>，若 <span class="math inline">\(gcd(a,b)=1\)</span>，则称 <span class="math inline">\(a,b\)</span> 互质。</p>
<p><strong>欧拉函数定义</strong></p>
<p><span class="math inline">\(1\sim N\)</span> 中<strong>与 <span class="math inline">\(N\)</span> 互质</strong>的数的<strong>个数</strong>被称为<strong>欧拉函数</strong>，记为 <span class="math inline">\(\varphi(N)\)</span>。</p>
<p>若在算术基本定理中，<span class="math inline">\(N=p_{1}^{c_1}p_{2}^{c_2}\cdots p_{m}^{c_m}\)</span>，则：</p>
<p><span class="math display">\[\varphi(N)=N* \frac{p_1-1}{p_1}*\frac{p_2-1}{p_2}*\cdots*\frac{p_m-1}{p_m}=N*\prod\limits_{质数p|N}(1-\frac{1}{p})\]</span></p>
<p>以上公式具体证明可参考<a target="_blank" rel="noopener" href="https://www.acwing.com/solution/content/8702/">AcWing 873. 欧拉函数-题解</a>。根据欧拉函数的计算公式，只需要分解质因数，即可顺便求出欧拉函数。</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">phi</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> x;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>; i &lt;= x / i; i ++ )<br>        <span class="hljs-keyword">if</span> (x % i == <span class="hljs-number">0</span>)<br>        &#123;<br>            res = res / i * (i - <span class="hljs-number">1</span>);<br>            <span class="hljs-keyword">while</span> (x % i == <span class="hljs-number">0</span>) x /= i;<br>        &#125;<br>    <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">1</span>) res = res / x * (x - <span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<h3 id="筛法求欧拉函数">筛法求欧拉函数</h3>
<p>例题：给定一个正整数 <span class="math inline">\(n\)</span>，求<span class="math inline">\(1\sim n\)</span>中每个数的欧拉函数之和。</p>
<p>原理及证明参考题解<a target="_blank" rel="noopener" href="https://www.acwing.com/solution/content/43470/">AcWing874.筛法求欧拉函数-题解</a>。</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] phi = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N];          <span class="hljs-comment">// 用于保存每个数字的欧拉函数</span><br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] primes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N];       <span class="hljs-comment">// primes[]存储所有素数</span><br><span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span>[] st = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[N];   <span class="hljs-comment">// st[x]存储x是否被筛掉</span><br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> cnt;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">get_eulers</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> &#123;<br>    phi[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>; <span class="hljs-comment">//1的欧拉函数为1</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>; i &lt;= n; i++)&#123;<br>        <span class="hljs-keyword">if</span>(!st[i])&#123;<br>            primes[cnt++] = i;<br>            phi[i] = i - <span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; primes[j] &lt;= n / i; j++)&#123;<br>            st[primes[j] * i] = <span class="hljs-literal">true</span>;<br>            phi[primes[j] * i] = phi[i] * (primes[j] - <span class="hljs-number">1</span>);<br>            <span class="hljs-keyword">if</span>(i % primes[j] == <span class="hljs-number">0</span>)&#123;<br>                phi[primes[j]*i] = phi[i] * primes[j];<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<h3 id="快速幂">快速幂</h3>
<p>求 <span class="math inline">\(a\)</span> 的 <span class="math inline">\(b\)</span> 次方对 <span class="math inline">\(p\)</span> 取模的值，其中 <span class="math inline">\(1 \le a,b,p \le 10^9\)</span>。</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">qmi</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">int</span> p)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> % p;<br>    <span class="hljs-keyword">while</span>(b &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">if</span>(b % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) res = (<span class="hljs-type">int</span>)((<span class="hljs-type">long</span>)res * a % p);<br>        b &gt;&gt;= <span class="hljs-number">1</span>;<br>        a = (<span class="hljs-type">int</span>)((<span class="hljs-type">long</span>)a * a % p);<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<p><strong>快速乘</strong></p>
<p>借鉴快速幂思想，求 <span class="math inline">\(a \times b\, mod\, p\)</span> 的结果。</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-type">long</span> <span class="hljs-title function_">qmul</span><span class="hljs-params">(<span class="hljs-type">long</span> a, <span class="hljs-type">long</span> b)</span>&#123;<br>    <span class="hljs-type">long</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">while</span>(b != <span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-keyword">if</span>(b % <span class="hljs-number">2</span> != <span class="hljs-number">0</span>) res = (res + a) % p;<br>        a = a * <span class="hljs-number">2</span> % p;<br>        b /= <span class="hljs-number">2</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<p><strong>快速幂求逆元</strong></p>
<p>费马小定理：如果 <span class="math inline">\(p\)</span> 是一个质数，而整数 a 不是 p 的倍数，则有 <span class="math inline">\(a^{p-1} \equiv 1(mod \, p)\)</span>。</p>
<p>乘法逆元定义</p>
<p>若整数 $ b，m$ 互质，并且对于任意的整数 <span class="math inline">\(a\)</span>，如果满足 <span class="math inline">\(b|a\)</span>，则存在一个整数 <span class="math inline">\(x\)</span>，使得<span class="math inline">\(a/b \equiv a\times x(mod \, m)\)</span>，则称 <span class="math inline">\(x\)</span> 为 <span class="math inline">\(b\)</span> 的模 <span class="math inline">\(m\)</span> 乘法逆元，记为 <span class="math inline">\(b^{-1}(mod\, m)\)</span>。 相关结论：<span class="math inline">\(b\)</span> 存在乘法逆元的充要条件是 <span class="math inline">\(b\)</span> 与模数 <span class="math inline">\(m\)</span> 互质。当模数 <span class="math inline">\(m\)</span> 为质数时，<span class="math inline">\(b^{m-2}\)</span> 即为 <span class="math inline">\(b\)</span> 的乘法逆元，当 <span class="math inline">\(b\)</span> 为 <span class="math inline">\(m\)</span> 的倍数时，<span class="math inline">\(b\)</span> 的逆元不存在，<span class="math inline">\(b \times x\,\%\, m == 0\)</span>，<span class="math inline">\(b\)</span> 乘任意一个 <span class="math inline">\(x \% m == 0\)</span> 一定等于 <span class="math inline">\(0\)</span>。</p>
<p>证明过程见题解<a target="_blank" rel="noopener" href="https://www.acwing.com/solution/content/16468/">AcWing 876. 费马小定理 - 快速幂求逆元</a>。</p>
<p>题目：给定 <span class="math inline">\(n\)</span> 组 <span class="math inline">\(a_i，p_i\)</span>，其中 <span class="math inline">\(p_i\)</span> 是质数，求 <span class="math inline">\(a_i\)</span> 模 <span class="math inline">\(p_i\)</span> 的乘法逆元，若逆元不存在则输出 <code>impossible</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">// 快速幂</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">qmi</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">int</span> p)</span> &#123;<br>    <span class="hljs-comment">// ...</span><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-type">Scanner</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> in.nextInt();<br>    <span class="hljs-keyword">while</span>(n-- &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> in.nextInt();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> in.nextInt();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> qmi(a, m - <span class="hljs-number">2</span>, m);<br>        <span class="hljs-keyword">if</span>(a % m != <span class="hljs-number">0</span>) System.out.println(res);<br>        <span class="hljs-keyword">else</span> System.out.println(<span class="hljs-string">&quot;impossible&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<p><strong>矩阵快速幂</strong></p>
<p>待补充。。。</p>
<h3 id="扩展欧几里得算法">扩展欧几里得算法</h3>
<p>题目：给定 <span class="math inline">\(n\)</span> 对正整数 <span class="math inline">\(a_i,b_i\)</span>，对于每对数，求出一组<span class="math inline">\(x_i,y_i\)</span>，使其满足<span class="math inline">\(a_i\times x_i+b_i\times y_i=gcd(a_i,b_i)\)</span>。</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.*;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">exgcd</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">int</span>[] x, <span class="hljs-type">int</span>[] y)</span> &#123;<br>        <span class="hljs-keyword">if</span> (b == <span class="hljs-number">0</span>) &#123;<br>            x[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>; <br>            y[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">return</span> a;<br>        &#125;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">d</span> <span class="hljs-operator">=</span> exgcd(b, a % b, y, x);<br>        y[<span class="hljs-number">0</span>] -= a / b * x[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">return</span> d;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span> <span class="hljs-params">(String[] argv)</span> &#123;<br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">sc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> sc.nextInt();<br>        <span class="hljs-type">int</span>[] x = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">1</span>];<br>        <span class="hljs-type">int</span>[] y = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">while</span> (n-- != <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> sc.nextInt();<br>            <span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> sc.nextInt();<br>            exgcd(a, b, x, y);<br>            System.out.print(x[<span class="hljs-number">0</span>] + <span class="hljs-string">&quot; &quot;</span>);<br>            System.out.println(y[<span class="hljs-number">0</span>]);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<h3 id="高斯消元">高斯消元</h3>
<p>待补充。。。</p>
<h3 id="组合数">组合数</h3>
<p>给定两个正整数 <span class="math inline">\(a\)</span> 与 <span class="math inline">\(b\)</span>，求 <span class="math inline">\(C_{a}^{b}\, mod \, (10_9+7)\)</span> 的值。针对不同的 <span class="math inline">\(a\)</span> 和 <span class="math inline">\(b\)</span> 取值范围有四种求解方式。</p>
<h4 id="递推法求组合数">递推法求组合数</h4>
<p>递推式：<span class="math inline">\(C_a^b=C_{a-1}^{b-1}+C_{a-1}^{b}\)</span>，时间复杂度<span class="math inline">\(O(n^2)\)</span>，数据范围：<span class="math inline">\(1\le b \le a \le 2000\)</span>。</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">N</span> <span class="hljs-operator">=</span> <span class="hljs-number">2010</span>, n, m = <span class="hljs-number">1000000007</span>;<br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[][] f = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N][N];<br><br><span class="hljs-comment">//初始化</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; N; i ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;j &lt;= i ; j ++ )<br>            <span class="hljs-keyword">if</span>(j == <span class="hljs-number">0</span>) f[i][j] = <span class="hljs-number">1</span>; <br>    <span class="hljs-keyword">else</span> f[i][j] = (f[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>] + f[i - <span class="hljs-number">1</span>][j]) % m;  <br>&#125;<br></code></pre></div></td></tr></table></figure>
<h4 id="通过预处理逆元的方式求组合数">通过预处理逆元的方式求组合数</h4>
<p><span class="math inline">\(C_{a}^{b}=\frac{a!}{b!(a-b)!}=a!*b!^{-1}*(a-b)!^{-1}\)</span>，时间复杂度<span class="math inline">\(O(a*log(mod))\)</span>，数据范围：<span class="math inline">\(1\le b \le a \le 10^5\)</span>。</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">// 快速幂</span><br><span class="hljs-keyword">static</span> Long <span class="hljs-title function_">qmi</span><span class="hljs-params">(<span class="hljs-type">int</span> a,<span class="hljs-type">int</span> b,<span class="hljs-type">int</span> p)</span> &#123;<br>    <span class="hljs-comment">// ...</span><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-type">BufferedReader</span> <span class="hljs-variable">reader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedReader</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(System.in));<br>    fact[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>    infact[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; N; i++)<br>    &#123;<br>        fact[i] = fact[i - <span class="hljs-number">1</span>] * i % mod;<br>        infact[i] = infact[i - <span class="hljs-number">1</span>] * qmi(i,mod - <span class="hljs-number">2</span>,mod) % mod;<br>    &#125;<br><br>    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> Integer.parseInt(reader.readLine().trim());<br>    <span class="hljs-keyword">while</span>(n -- &gt; <span class="hljs-number">0</span>)<br>    &#123;<br>        String[] s1 = reader.readLine().split(<span class="hljs-string">&quot; &quot;</span>);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> Integer.parseInt(s1[<span class="hljs-number">0</span>]);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> Integer.parseInt(s1[<span class="hljs-number">1</span>]);<br>        System.out.println(fact[a] * infact[a - b] % mod * infact[b] % mod);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<h4 id="lucas定理">Lucas定理</h4>
<p>题目：给定 <span class="math inline">\(n\)</span> 组询问，每组询问给定三个整数 <span class="math inline">\(a,b,p\)</span>，其中 <span class="math inline">\(p\)</span> 是质数，请你输出 <span class="math inline">\(C_a^b \, mod \,p\)</span> 的值。数据范围：<span class="math inline">\(1\le n\le 20, 1 \le b \le a \le 10^{18}, 1 \le p \le 10^5\)</span>。</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">long</span> <span class="hljs-title function_">qmi</span><span class="hljs-params">(<span class="hljs-type">long</span> a,<span class="hljs-type">long</span> k,<span class="hljs-type">int</span> p)</span><br>&#123;<br>    <span class="hljs-type">long</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> % p;<br>    <span class="hljs-keyword">while</span>(k &gt; <span class="hljs-number">0</span>)<br>    &#123;<br>        <span class="hljs-keyword">if</span>((k &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">1</span>) res = res * a % p;<br>        k &gt;&gt;= <span class="hljs-number">1</span>;<br>        a = a * a % p;<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">long</span> <span class="hljs-title function_">C</span><span class="hljs-params">(<span class="hljs-type">long</span> a,<span class="hljs-type">long</span> b,<span class="hljs-type">int</span> p)</span><br>&#123;<br>    <span class="hljs-keyword">if</span>(b &gt; a) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-type">long</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">long</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> a,j = b; j &gt;= <span class="hljs-number">1</span>;i --,j --)<br>    &#123;<br>        res = res * i % p;<br>        res = res * qmi(j,p - <span class="hljs-number">2</span>,p) % p;<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">long</span> <span class="hljs-title function_">lucas</span><span class="hljs-params">(<span class="hljs-type">long</span> a,<span class="hljs-type">long</span> b,<span class="hljs-type">int</span> p)</span><br>&#123;<br>    <span class="hljs-keyword">if</span>(a &lt; p &amp;&amp; b &lt; p) <span class="hljs-keyword">return</span> C(a,b,p);<br>    <span class="hljs-keyword">return</span> C(a % p,b % p,p) * lucas(a / p,b / p,p) % p;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    <span class="hljs-type">Scanner</span> <span class="hljs-variable">scan</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> scan.nextInt();<br>    <span class="hljs-keyword">while</span>(n -- &gt; <span class="hljs-number">0</span>)<br>    &#123;<br>        <span class="hljs-type">long</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> scan.nextLong();<br>        <span class="hljs-type">long</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> scan.nextLong();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> scan.nextInt();<br>        System.out.println(lucas(a,b,p));<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<h4 id="分解质因数法求组合数">分解质因数法求组合数</h4>
<p>由于计算不取模，所以必须使用高精度乘法；因为只询问一次，所以直接按定义计算就行，不需要预处理；但是要避免除法，所以要计算分子分母相消之后的剩余值在相乘，为了方便相消，所以要统计分子和分母的质因子个数。</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">N</span> <span class="hljs-operator">=</span> <span class="hljs-number">5010</span>;<br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] primes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N];<br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">cnt</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span>[] st = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[N];<br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] sum = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N];<br><br><span class="hljs-comment">//线性筛法求质数</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">get_primes</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span><br>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;i &lt;= n;i++)<br>    &#123;<br>        <span class="hljs-keyword">if</span>(!st[i]) primes[cnt ++] = i;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;primes[j] &lt;= n / i;j++)<br>        &#123;<br>            st[primes[j] * i] = <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">if</span>(i % primes[j] == <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//记录p中多少个</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> n,<span class="hljs-type">int</span> p)</span><br>&#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(n &gt; <span class="hljs-number">0</span>)<br>    &#123;<br>        res += n / p;<br>        n /= p;<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Integer&gt; <span class="hljs-title function_">mul</span><span class="hljs-params">(List&lt;Integer&gt; a,<span class="hljs-type">int</span> b)</span><br>&#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;i &lt; a.size();i++)<br>    &#123;<br>        t += a.get(i) * b;<br>        a.set(i, t % <span class="hljs-number">10</span>);<br>        t /= <span class="hljs-number">10</span>;<br>    &#125;<br>    <span class="hljs-keyword">while</span>(t != <span class="hljs-number">0</span>)<br>    &#123;<br>        a.add(t % <span class="hljs-number">10</span>);<br>        t /= <span class="hljs-number">10</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> a;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    <span class="hljs-type">Scanner</span> <span class="hljs-variable">scan</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>    <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> scan.nextInt();<br>    <span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> scan.nextInt();<br>    get_primes(a);<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;i &lt; cnt;i++)<br>    &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> primes[i];<br>        sum[i] = get(a,p) - get(a - b,p) - get(b,p);<br>    &#125;<br>    List&lt;Integer&gt; res = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Integer&gt;();<br>    res.add(<span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;i &lt; cnt;i++)<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;j &lt; sum[i];j++)<br>            res = mul(res,primes[i]);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> res.size() - <span class="hljs-number">1</span>;i &gt;= <span class="hljs-number">0</span>;i --)<br>        System.out.print(res.get(i));<br>&#125;<br></code></pre></div></td></tr></table></figure>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Algorithm/">Algorithm</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E7%AE%97%E6%B3%95/">算法</a>
                    
                      <a class="hover-with-bg" href="/tags/Java/">Java</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  <!-- 
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                   -->
				  <strong>本文作者: </strong><a href="/">Seon Fang</a> <br>
				  <strong>本文链接: </strong><a href="http://example.com/Algorithm/Mathematics/">http://example.com/Algorithm/Mathematics/</a> <br>
                  <strong>版权声明: </strong>本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/Algorithm/DynamicProgramming/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">动态规划</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/JUC/Thread_NoLock/">
                        <span class="hidden-mobile">Java并发编程——共享模型之无锁</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <div id="gitalk-container"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#gitalk-container', function() {
      Fluid.utils.createCssLink('/css/gitalk.css')
      Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', function() {
        var options = Object.assign(
          {"clientID":"1f52e6d566b01ad34a0b","clientSecret":"ee37abaab13a3b0680ef4c2558aa82c886598d75","repo":"Hexo_Blog_Comments","owner":"Xylitol415","admin":["Xylitol415"],"language":"zh-CN","labels":["Gitalk"],"perPage":10,"pagerDirection":"last","distractionFreeMode":false,"createIssueManually":true,"proxy":"https://shielded-brushlands-08810.herokuapp.com/https://github.com/login/oauth/access_token"},
          {
            id: '6ac9e099229840bd38dc6a2f9badeb5c'
          }
        )
        var gitalk = new Gitalk(options);
        gitalk.render('gitalk-container');
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->





      <script>
          function setClipboardText(event){
              // clipboardData 对象是为通过编辑菜单、快捷菜单和快捷键执行的编辑操作所保留的，也就是你复制或者剪切内容
              let clipboardData = event.clipboardData || window.clipboardData;
              // 如果未复制或者未剪切，则return出去
              if (!clipboardData) { return; }
              event.preventDefault();
              // Selection 对象，表示用户选择的文本范围或光标的当前位置。
              //     声明一个变量接收 -- 用户输入的剪切或者复制的文本转化为字符串
              let text = window.getSelection().toString();
			  let len = text.length;
			  
			// 复制文字超过120个就加上版权信息
              if (len >= 120) {
                // 如果文本存在则先取消文本默认事件
                event.preventDefault();
                // 通过调用常clipboardData对象的 setData(format, data) 方法；来设置相关文本
                // format: 一个DOMString 表示要添加到 drag object的拖动数据的类型。
                // data: 一个 DOMString表示要添加到 drag object的数据。
                var copyright = '\n\n'
								+ '------------------------------------------------------'
                                + '\n著作权归作者所有。'
                                + '\n商业转载请联系作者获得授权，非商业转载请注明出处。'
                                + '\n作者: Seon Fang'
                                + '\n邮箱: fx940415@163.com'
                                + '\n原文地址: http://example.com/Algorithm/Mathematics/'
    
                clipboardData.setData('text/plain', text + copyright);
    
              } else {
				clipboardData.setData('text/plain', text);
			  }
          };
          var contents = document.getElementsByClassName("container-fluid nopadding-x");
          // 监听文章内容的copy事件
          contents[0].addEventListener('copy',function(e){
              setClipboardText(e);
          });
      </script>


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <p><span>Copyright&nbsp;<i class="iconfont icon-copyright"></i>&nbsp;2020-2022 Seon Fang. All rights reserved.</span></p> <p><i class="iconfont icon-map"></i><span>&nbsp;Haidian District, Beijing, China</span></p> <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Powered by Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a>    
  </div>
  

  

  
  
  <!-- 添加网站运行时间 -->
	<div class="footer-content">
	  <span id="timeDate">载入天数...</span>
	  <span id="times">载入时分秒...</span>
	  <script>
	  var now = new Date();
	  function createtime(){
		  var grt= new Date("04/05/2022 00:00:00");//此处修改你的建站时间或者网站上线时间
		  now.setTime(now.getTime()+250);
		  days = (now - grt ) / 1000 / 60 / 60 / 24;
		  dnum = Math.floor(days);
		  hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
		  hnum = Math.floor(hours);
		  if(String(hnum).length ==1 ){
			  hnum = "0" + hnum;
		  }
		  minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
		  mnum = Math.floor(minutes);
		  if(String(mnum).length ==1 ){
					mnum = "0" + mnum;
		  }
		  seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
		  snum = Math.round(seconds);
		  if(String(snum).length ==1 ){
					snum = "0" + snum;
		  }
		  document.getElementById("timeDate").innerHTML = "🚀 for&nbsp"+dnum+"&nbspdays";  //此次自定义显示内容
		  document.getElementById("times").innerHTML = hnum + "&nbsphr&nbsp" + mnum + "&nbspmin&nbsp" + snum + "&nbspsec";
	  }  //此次自定义显示内容
	  setInterval("createtime()",250);
	  </script>
	</div>
  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        loader: {
          load: ['ui/lazy']
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" ></script>

  











<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
